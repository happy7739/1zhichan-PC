/*!
 * jQuery UI Datepicker 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/datepicker/
 */
M.define("jqui-datepicker",function(d){d("jqui-core");$.extend($.ui,{datepicker:{version:"1.11.3"}});var g;function h(j){var i,k;while(j.length&&j[0]!==document){i=j.css("position");if(i==="absolute"||i==="relative"||i==="fixed"){k=parseInt(j.css("zIndex"),10);if(!isNaN(k)&&k!==0){return k}}j=j.parent()}return 0}function c(){this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};$.extend(this._defaults,this.regional[""]);this.regional.en=$.extend(true,{},this.regional[""]);this.regional["en-US"]=$.extend(true,{},this.regional.en);this.dpDiv=b($("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}$.extend(c.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(i){a(this._defaults,i||{});return this},_attachDatepicker:function(l,i){var m,k,j;m=l.nodeName.toLowerCase();k=(m==="div"||m==="span");if(!l.id){this.uuid+=1;l.id="dp"+this.uuid}j=this._newInst($(l),k);j.settings=$.extend({},i||{});if(m==="input"){this._connectDatepicker(l,j)}else{if(k){this._inlineDatepicker(l,j)}}},_newInst:function(j,i){var k=j[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:k,input:j,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:(!i?this.dpDiv:b($("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")))}},_connectDatepicker:function(k,j){var i=$(k);j.append=$([]);j.trigger=$([]);if(i.hasClass(this.markerClassName)){return}this._attachments(i,j);i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp);this._autoSize(j);$.data(k,"datepicker",j);if(j.settings.disabled){this._disableDatepicker(k)}},_attachments:function(k,n){var j,m,i,o=this._get(n,"appendText"),l=this._get(n,"isRTL");if(n.append){n.append.remove()}if(o){n.append=$("<span class='"+this._appendClass+"'>"+o+"</span>");k[l?"before":"after"](n.append)}k.unbind("focus",this._showDatepicker);if(n.trigger){n.trigger.remove()}j=this._get(n,"showOn");if(j==="focus"||j==="both"){k.focus(this._showDatepicker)}if(j==="button"||j==="both"){m=this._get(n,"buttonText");i=this._get(n,"buttonImage");n.trigger=$(this._get(n,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:i,alt:m,title:m}):$("<button type='button'></button>").addClass(this._triggerClass).html(!i?m:$("<img/>").attr({src:i,alt:m,title:m})));k[l?"before":"after"](n.trigger);n.trigger.click(function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput===k[0]){$.datepicker._hideDatepicker()}else{if($.datepicker._datepickerShowing&&$.datepicker._lastInput!==k[0]){$.datepicker._hideDatepicker();$.datepicker._showDatepicker(k[0])}else{$.datepicker._showDatepicker(k[0])}}return false})}},_autoSize:function(p){if(this._get(p,"autoSize")&&!p.inline){var m,k,l,o,n=new Date(2009,12-1,20),j=this._get(p,"dateFormat");if(j.match(/[DM]/)){m=function(i){k=0;l=0;for(o=0;o<i.length;o++){if(i[o].length>k){k=i[o].length;l=o}}return l};n.setMonth(m(this._get(p,(j.match(/MM/)?"monthNames":"monthNamesShort"))));n.setDate(m(this._get(p,(j.match(/DD/)?"dayNames":"dayNamesShort")))+20-n.getDay())}p.input.attr("size",this._formatDate(p,n).length)}},_inlineDatepicker:function(j,i){var k=$(j);if(k.hasClass(this.markerClassName)){return}k.addClass(this.markerClassName).append(i.dpDiv);$.data(j,"datepicker",i);this._setDate(i,this._getDefaultDate(i),true);this._updateDatepicker(i);this._updateAlternate(i);if(i.settings.disabled){this._disableDatepicker(j)}i.dpDiv.css("display","block")},_dialogDatepicker:function(p,j,n,k,o){var i,s,m,r,q,l=this._dialogInst;if(!l){this.uuid+=1;i="dp"+this.uuid;this._dialogInput=$("<input type='text' id='"+i+"' style='position: absolute; top: -100px; width: 0px;'/>");this._dialogInput.keydown(this._doKeyDown);$("body").append(this._dialogInput);l=this._dialogInst=this._newInst(this._dialogInput,false);l.settings={};$.data(this._dialogInput[0],"datepicker",l)}a(l.settings,k||{});j=(j&&j.constructor===Date?this._formatDate(l,j):j);this._dialogInput.val(j);this._pos=(o?(o.length?o:[o.pageX,o.pageY]):null);if(!this._pos){s=document.documentElement.clientWidth;m=document.documentElement.clientHeight;r=document.documentElement.scrollLeft||document.body.scrollLeft;q=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(s/2)-100+r,(m/2)-150+q]}this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");l.settings.onSelect=n;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI){$.blockUI(this.dpDiv)}$.data(this._dialogInput[0],"datepicker",l);return this},_destroyDatepicker:function(k){var l,i=$(k),j=$.data(k,"datepicker");if(!i.hasClass(this.markerClassName)){return}l=k.nodeName.toLowerCase();$.removeData(k,"datepicker");if(l==="input"){j.append.remove();j.trigger.remove();i.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else{if(l==="div"||l==="span"){i.removeClass(this.markerClassName).empty()}}if(g===j){g=null}},_enableDatepicker:function(l){var m,k,i=$(l),j=$.data(l,"datepicker");if(!i.hasClass(this.markerClassName)){return}m=l.nodeName.toLowerCase();if(m==="input"){l.disabled=false;j.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else{if(m==="div"||m==="span"){k=i.children("."+this._inlineClass);k.children().removeClass("ui-state-disabled");k.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",false)}}this._disabledInputs=$.map(this._disabledInputs,function(n){return(n===l?null:n)})},_disableDatepicker:function(l){var m,k,i=$(l),j=$.data(l,"datepicker");if(!i.hasClass(this.markerClassName)){return}m=l.nodeName.toLowerCase();if(m==="input"){l.disabled=true;j.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else{if(m==="div"||m==="span"){k=i.children("."+this._inlineClass);k.children().addClass("ui-state-disabled");k.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",true)}}this._disabledInputs=$.map(this._disabledInputs,function(n){return(n===l?null:n)});this._disabledInputs[this._disabledInputs.length]=l},_isDisabledDatepicker:function(k){if(!k){return false}for(var j=0;j<this._disabledInputs.length;j++){if(this._disabledInputs[j]===k){return true}}return false},_getInst:function(j){try{return $.data(j,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(o,j,n){var k,i,m,p,l=this._getInst(o);if(arguments.length===2&&typeof j==="string"){return(j==="defaults"?$.extend({},$.datepicker._defaults):(l?(j==="all"?$.extend({},l.settings):this._get(l,j)):null))}k=j||{};if(typeof j==="string"){k={};k[j]=n}if(l){if(this._curInst===l){this._hideDatepicker()}i=this._getDateDatepicker(o,true);m=this._getMinMaxDate(l,"min");p=this._getMinMaxDate(l,"max");a(l.settings,k);if(m!==null&&k.dateFormat!==undefined&&k.minDate===undefined){l.settings.minDate=this._formatDate(l,m)}if(p!==null&&k.dateFormat!==undefined&&k.maxDate===undefined){l.settings.maxDate=this._formatDate(l,p)}if("disabled" in k){if(k.disabled){this._disableDatepicker(o)}else{this._enableDatepicker(o)}}this._attachments($(o),l);this._autoSize(l);this._setDate(l,i);this._updateAlternate(l);this._updateDatepicker(l)}},_changeDatepicker:function(k,i,j){this._optionDatepicker(k,i,j)},_refreshDatepicker:function(j){var i=this._getInst(j);if(i){this._updateDatepicker(i)}},_setDateDatepicker:function(k,i){var j=this._getInst(k);if(j){this._setDate(j,i);this._updateDatepicker(j);this._updateAlternate(j)}},_getDateDatepicker:function(k,i){var j=this._getInst(k);if(j&&!j.inline){this._setDateFromField(j,i)}return(j?this._getDate(j):null)},_doKeyDown:function(l){var j,i,n,m=$.datepicker._getInst(l.target),o=true,k=m.dpDiv.is(".ui-datepicker-rtl");m._keyEvent=true;if($.datepicker._datepickerShowing){switch(l.keyCode){case 9:$.datepicker._hideDatepicker();o=false;break;case 13:n=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",m.dpDiv);if(n[0]){$.datepicker._selectDay(l.target,m.selectedMonth,m.selectedYear,n[0])}j=$.datepicker._get(m,"onSelect");if(j){i=$.datepicker._formatDate(m);j.apply((m.input?m.input[0]:null),[i,m])}else{$.datepicker._hideDatepicker()}return false;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(l.target,(l.ctrlKey?-$.datepicker._get(m,"stepBigMonths"):-$.datepicker._get(m,"stepMonths")),"M");break;case 34:$.datepicker._adjustDate(l.target,(l.ctrlKey?+$.datepicker._get(m,"stepBigMonths"):+$.datepicker._get(m,"stepMonths")),"M");break;case 35:if(l.ctrlKey||l.metaKey){$.datepicker._clearDate(l.target)}o=l.ctrlKey||l.metaKey;break;case 36:if(l.ctrlKey||l.metaKey){$.datepicker._gotoToday(l.target)}o=l.ctrlKey||l.metaKey;break;case 37:if(l.ctrlKey||l.metaKey){$.datepicker._adjustDate(l.target,(k?+1:-1),"D")}o=l.ctrlKey||l.metaKey;if(l.originalEvent.altKey){$.datepicker._adjustDate(l.target,(l.ctrlKey?-$.datepicker._get(m,"stepBigMonths"):-$.datepicker._get(m,"stepMonths")),"M")}break;case 38:if(l.ctrlKey||l.metaKey){$.datepicker._adjustDate(l.target,-7,"D")}o=l.ctrlKey||l.metaKey;break;case 39:if(l.ctrlKey||l.metaKey){$.datepicker._adjustDate(l.target,(k?-1:+1),"D")}o=l.ctrlKey||l.metaKey;if(l.originalEvent.altKey){$.datepicker._adjustDate(l.target,(l.ctrlKey?+$.datepicker._get(m,"stepBigMonths"):+$.datepicker._get(m,"stepMonths")),"M")}break;case 40:if(l.ctrlKey||l.metaKey){$.datepicker._adjustDate(l.target,+7,"D")}o=l.ctrlKey||l.metaKey;break;default:o=false}}else{if(l.keyCode===36&&l.ctrlKey){$.datepicker._showDatepicker(this)}else{o=false}}if(o){l.preventDefault();l.stopPropagation()}},_doKeyPress:function(k){var j,i,l=$.datepicker._getInst(k.target);if($.datepicker._get(l,"constrainInput")){j=$.datepicker._possibleChars($.datepicker._get(l,"dateFormat"));i=String.fromCharCode(k.charCode==null?k.keyCode:k.charCode);return k.ctrlKey||k.metaKey||(i<" "||!j||j.indexOf(i)>-1)}},_doKeyUp:function(k){var i,l=$.datepicker._getInst(k.target);if(l.input.val()!==l.lastVal){try{i=$.datepicker.parseDate($.datepicker._get(l,"dateFormat"),(l.input?l.input.val():null),$.datepicker._getFormatConfig(l));if(i){$.datepicker._setDateFromField(l);$.datepicker._updateAlternate(l);$.datepicker._updateDatepicker(l)}}catch(j){}}return true},_showDatepicker:function(j){j=j.target||j;if(j.nodeName.toLowerCase()!=="input"){j=$("input",j.parentNode)[0]}if($.datepicker._isDisabledDatepicker(j)||$.datepicker._lastInput===j){return}var l,p,k,n,o,i,m;l=$.datepicker._getInst(j);if($.datepicker._curInst&&$.datepicker._curInst!==l){$.datepicker._curInst.dpDiv.stop(true,true);if(l&&$.datepicker._datepickerShowing){$.datepicker._hideDatepicker($.datepicker._curInst.input[0])}}p=$.datepicker._get(l,"beforeShow");k=p?p.apply(j,[j,l]):{};if(k===false){return}a(l.settings,k);l.lastVal=null;$.datepicker._lastInput=j;$.datepicker._setDateFromField(l);if($.datepicker._inDialog){j.value=""}if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(j);$.datepicker._pos[1]+=j.offsetHeight}n=false;$(j).parents().each(function(){n|=$(this).css("position")==="fixed";return !n});o={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;l.dpDiv.empty();l.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(l);o=$.datepicker._checkOffset(l,o,n);l.dpDiv.css({position:($.datepicker._inDialog&&$.blockUI?"static":(n?"fixed":"absolute")),display:"none",left:o.left+"px",top:o.top+"px"});if(!l.inline){i=$.datepicker._get(l,"showAnim");m=$.datepicker._get(l,"duration");l.dpDiv.css("z-index",h($(j))+1);$.datepicker._datepickerShowing=true;if($.effects&&$.effects.effect[i]){l.dpDiv.show(i,$.datepicker._get(l,"showOptions"),m)}else{l.dpDiv[i||"show"](i?m:null)}if($.datepicker._shouldFocusInput(l)){l.input.focus()}$.datepicker._curInst=l}},_updateDatepicker:function(l){this.maxRows=4;g=l;l.dpDiv.empty().append(this._generateHTML(l));this._attachHandlers(l);var n,i=this._getNumberOfMonths(l),m=i[1],k=17,j=l.dpDiv.find("."+this._dayOverClass+" a");if(j.length>0){f.apply(j.get(0))}l.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(m>1){l.dpDiv.addClass("ui-datepicker-multi-"+m).css("width",(k*m)+"em")}l.dpDiv[(i[0]!==1||i[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi");l.dpDiv[(this._get(l,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(l===$.datepicker._curInst&&$.datepicker._datepickerShowing&&$.datepicker._shouldFocusInput(l)){l.input.focus()}if(l.yearshtml){n=l.yearshtml;setTimeout(function(){if(n===l.yearshtml&&l.yearshtml){l.dpDiv.find("select.ui-datepicker-year:first").replaceWith(l.yearshtml)}n=l.yearshtml=null},0)}},_shouldFocusInput:function(i){return i.input&&i.input.is(":visible")&&!i.input.is(":disabled")&&!i.input.is(":focus")},_checkOffset:function(n,l,k){var m=n.dpDiv.outerWidth(),q=n.dpDiv.outerHeight(),p=n.input?n.input.outerWidth():0,i=n.input?n.input.outerHeight():0,o=document.documentElement.clientWidth+(k?0:$(document).scrollLeft()),j=document.documentElement.clientHeight+(k?0:$(document).scrollTop());l.left-=(this._get(n,"isRTL")?(m-p):0);l.left-=(k&&l.left===n.input.offset().left)?$(document).scrollLeft():0;l.top-=(k&&l.top===(n.input.offset().top+i))?$(document).scrollTop():0;l.left-=Math.min(l.left,(l.left+m>o&&o>m)?Math.abs(l.left+m-o):0);l.top-=Math.min(l.top,(l.top+q>j&&j>q)?Math.abs(q+i):0);return l},_findPos:function(l){var i,k=this._getInst(l),j=this._get(k,"isRTL");while(l&&(l.type==="hidden"||l.nodeType!==1||$.expr.filters.hidden(l))){l=l[j?"previousSibling":"nextSibling"]}i=$(l).offset();return[i.left,i.top]},_hideDatepicker:function(k){var j,n,m,i,l=this._curInst;if(!l||(k&&l!==$.data(k,"datepicker"))){return}if(this._datepickerShowing){j=this._get(l,"showAnim");n=this._get(l,"duration");m=function(){$.datepicker._tidyDialog(l)};if($.effects&&($.effects.effect[j]||$.effects[j])){l.dpDiv.hide(j,$.datepicker._get(l,"showOptions"),n,m)}else{l.dpDiv[(j==="slideDown"?"slideUp":(j==="fadeIn"?"fadeOut":"hide"))]((j?n:null),m)}if(!j){m()}this._datepickerShowing=false;i=this._get(l,"onClose");if(i){i.apply((l.input?l.input[0]:null),[(l.input?l.input.val():""),l])}this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(i){i.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(j){if(!$.datepicker._curInst){return}var i=$(j.target),k=$.datepicker._getInst(i[0]);if(((i[0].id!==$.datepicker._mainDivId&&i.parents("#"+$.datepicker._mainDivId).length===0&&!i.hasClass($.datepicker.markerClassName)&&!i.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)))||(i.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!==k)){$.datepicker._hideDatepicker()}},_adjustDate:function(m,l,k){var j=$(m),i=this._getInst(j[0]);if(this._isDisabledDatepicker(j[0])){return}this._adjustInstDate(i,l+(k==="M"?this._get(i,"showCurrentAtPos"):0),k);this._updateDatepicker(i)},_gotoToday:function(l){var i,k=$(l),j=this._getInst(k[0]);if(this._get(j,"gotoCurrent")&&j.currentDay){j.selectedDay=j.currentDay;j.drawMonth=j.selectedMonth=j.currentMonth;j.drawYear=j.selectedYear=j.currentYear}else{i=new Date();j.selectedDay=i.getDate();j.drawMonth=j.selectedMonth=i.getMonth();j.drawYear=j.selectedYear=i.getFullYear()}this._notifyChange(j);this._adjustDate(k)},_selectMonthYear:function(m,i,l){var k=$(m),j=this._getInst(k[0]);j["selected"+(l==="M"?"Month":"Year")]=j["draw"+(l==="M"?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10);this._notifyChange(j);this._adjustDate(k)},_selectDay:function(n,l,i,m){var j,k=$(n);if($(m).hasClass(this._unselectableClass)||this._isDisabledDatepicker(k[0])){return}j=this._getInst(k[0]);j.selectedDay=j.currentDay=$("a",m).html();j.selectedMonth=j.currentMonth=l;j.selectedYear=j.currentYear=i;this._selectDate(n,this._formatDate(j,j.currentDay,j.currentMonth,j.currentYear))},_clearDate:function(j){var i=$(j);this._selectDate(i,"")},_selectDate:function(m,i){var j,l=$(m),k=this._getInst(l[0]);i=(i!=null?i:this._formatDate(k));if(k.input){k.input.val(i)}this._updateAlternate(k);j=this._get(k,"onSelect");if(j){j.apply((k.input?k.input[0]:null),[i,k])}else{if(k.input){k.input.trigger("change")}}if(k.inline){this._updateDatepicker(k)}else{this._hideDatepicker();this._lastInput=k.input[0];if(typeof(k.input[0])!=="object"){k.input.focus()}this._lastInput=null}},_updateAlternate:function(m){var l,k,i,j=this._get(m,"altField");if(j){l=this._get(m,"altFormat")||this._get(m,"dateFormat");k=this._getDate(m);i=this.formatDate(l,k,this._getFormatConfig(m));$(j).each(function(){$(this).val(i)})}},noWeekends:function(j){var i=j.getDay();return[(i>0&&i<6),""]},iso8601Week:function(i){var j,k=new Date(i.getTime());k.setDate(k.getDate()+4-(k.getDay()||7));j=k.getTime();k.setMonth(0);k.setDate(1);return Math.floor(Math.round((j-k)/86400000)/7)+1},parseDate:function(y,t,A){if(y==null||t==null){throw"Invalid arguments"}t=(typeof t==="object"?t.toString():t+"");if(t===""){return null}var l,v,j,z=0,o=(A?A.shortYearCutoff:null)||this._defaults.shortYearCutoff,k=(typeof o!=="string"?o:new Date().getFullYear()%100+parseInt(o,10)),r=(A?A.dayNamesShort:null)||this._defaults.dayNamesShort,C=(A?A.dayNames:null)||this._defaults.dayNames,i=(A?A.monthNamesShort:null)||this._defaults.monthNamesShort,m=(A?A.monthNames:null)||this._defaults.monthNames,n=-1,D=-1,x=-1,q=-1,w=false,B,s=function(F){var G=(l+1<y.length&&y.charAt(l+1)===F);if(G){l++}return G},E=function(H){var F=s(H),I=(H==="@"?14:(H==="!"?20:(H==="y"&&F?4:(H==="o"?3:2)))),K=(H==="y"?I:1),J=new RegExp("^\\d{"+K+","+I+"}"),G=t.substring(z).match(J);if(!G){throw"Missing number at position "+z}z+=G[0].length;return parseInt(G[0],10)},p=function(G,H,J){var F=-1,I=$.map(s(G)?J:H,function(L,K){return[[K,L]]}).sort(function(L,K){return -(L[1].length-K[1].length)});$.each(I,function(L,N){var K=N[1];if(t.substr(z,K.length).toLowerCase()===K.toLowerCase()){F=N[0];z+=K.length;return false}});if(F!==-1){return F+1}else{throw"Unknown name at position "+z}},u=function(){if(t.charAt(z)!==y.charAt(l)){throw"Unexpected literal at position "+z}z++};for(l=0;l<y.length;l++){if(w){if(y.charAt(l)==="'"&&!s("'")){w=false}else{u()}}else{switch(y.charAt(l)){case"d":x=E("d");break;case"D":p("D",r,C);break;case"o":q=E("o");break;case"m":D=E("m");break;case"M":D=p("M",i,m);break;case"y":n=E("y");break;case"@":B=new Date(E("@"));n=B.getFullYear();D=B.getMonth()+1;x=B.getDate();break;case"!":B=new Date((E("!")-this._ticksTo1970)/10000);n=B.getFullYear();D=B.getMonth()+1;x=B.getDate();break;case"'":if(s("'")){u()}else{w=true}break;default:u()}}}if(z<t.length){j=t.substr(z);if(!/^\s+/.test(j)){throw"Extra/unparsed characters found in date: "+j}}if(n===-1){n=new Date().getFullYear()}else{if(n<100){n+=new Date().getFullYear()-new Date().getFullYear()%100+(n<=k?0:-100)}}if(q>-1){D=1;x=q;do{v=this._getDaysInMonth(n,D-1);if(x<=v){break}D++;x-=v}while(true)}B=this._daylightSavingAdjust(new Date(n,D-1,x));if(B.getFullYear()!==n||B.getMonth()+1!==D||B.getDate()!==x){throw"Invalid date"}return B},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*10000000),formatDate:function(r,l,m){if(!l){return""}var t,u=(m?m.dayNamesShort:null)||this._defaults.dayNamesShort,j=(m?m.dayNames:null)||this._defaults.dayNames,p=(m?m.monthNamesShort:null)||this._defaults.monthNamesShort,n=(m?m.monthNames:null)||this._defaults.monthNames,s=function(v){var w=(t+1<r.length&&r.charAt(t+1)===v);if(w){t++}return w},i=function(x,y,v){var w=""+y;if(s(x)){while(w.length<v){w="0"+w}}return w},o=function(v,x,w,y){return(s(v)?y[x]:w[x])},k="",q=false;if(l){for(t=0;t<r.length;t++){if(q){if(r.charAt(t)==="'"&&!s("'")){q=false}else{k+=r.charAt(t)}}else{switch(r.charAt(t)){case"d":k+=i("d",l.getDate(),2);break;case"D":k+=o("D",l.getDay(),u,j);break;case"o":k+=i("o",Math.round((new Date(l.getFullYear(),l.getMonth(),l.getDate()).getTime()-new Date(l.getFullYear(),0,0).getTime())/86400000),3);break;case"m":k+=i("m",l.getMonth()+1,2);break;case"M":k+=o("M",l.getMonth(),p,n);break;case"y":k+=(s("y")?l.getFullYear():(l.getYear()%100<10?"0":"")+l.getYear()%100);break;case"@":k+=l.getTime();break;case"!":k+=l.getTime()*10000+this._ticksTo1970;break;case"'":if(s("'")){k+="'"}else{q=true}break;default:k+=r.charAt(t)}}}}return k},_possibleChars:function(m){var l,k="",j=false,i=function(n){var o=(l+1<m.length&&m.charAt(l+1)===n);if(o){l++}return o};for(l=0;l<m.length;l++){if(j){if(m.charAt(l)==="'"&&!i("'")){j=false}else{k+=m.charAt(l)}}else{switch(m.charAt(l)){case"d":case"m":case"y":case"@":k+="0123456789";break;case"D":case"M":return null;case"'":if(i("'")){k+="'"}else{j=true}break;default:k+=m.charAt(l)}}}return k},_get:function(j,i){return j.settings[i]!==undefined?j.settings[i]:this._defaults[i]},_setDateFromField:function(n,k){if(n.input.val()===n.lastVal){return}var i=this._get(n,"dateFormat"),p=n.lastVal=n.input?n.input.val():null,o=this._getDefaultDate(n),j=o,l=this._getFormatConfig(n);try{j=this.parseDate(i,p,l)||o}catch(m){p=(k?"":p)}n.selectedDay=j.getDate();n.drawMonth=n.selectedMonth=j.getMonth();n.drawYear=n.selectedYear=j.getFullYear();n.currentDay=(p?j.getDate():0);n.currentMonth=(p?j.getMonth():0);n.currentYear=(p?j.getFullYear():0);this._adjustInstDate(n)},_getDefaultDate:function(i){return this._restrictMinMax(i,this._determineDate(i,this._get(i,"defaultDate"),new Date()))},_determineDate:function(m,j,n){var l=function(p){var o=new Date();o.setDate(o.getDate()+p);return o},k=function(v){try{return $.datepicker.parseDate($.datepicker._get(m,"dateFormat"),v,$.datepicker._getFormatConfig(m))}catch(u){}var p=(v.toLowerCase().match(/^c/)?$.datepicker._getDate(m):null)||new Date(),q=p.getFullYear(),t=p.getMonth(),o=p.getDate(),s=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,r=s.exec(v);while(r){switch(r[2]||"d"){case"d":case"D":o+=parseInt(r[1],10);break;case"w":case"W":o+=parseInt(r[1],10)*7;break;case"m":case"M":t+=parseInt(r[1],10);o=Math.min(o,$.datepicker._getDaysInMonth(q,t));break;case"y":case"Y":q+=parseInt(r[1],10);o=Math.min(o,$.datepicker._getDaysInMonth(q,t));break}r=s.exec(v)}return new Date(q,t,o)},i=(j==null||j===""?n:(typeof j==="string"?k(j):(typeof j==="number"?(isNaN(j)?n:l(j)):new Date(j.getTime()))));i=(i&&i.toString()==="Invalid Date"?n:i);if(i){i.setHours(0);i.setMinutes(0);i.setSeconds(0);i.setMilliseconds(0)}return this._daylightSavingAdjust(i)},_daylightSavingAdjust:function(i){if(!i){return null}i.setHours(i.getHours()>12?i.getHours()+2:0);return i},_setDate:function(o,l,n){var i=!l,k=o.selectedMonth,m=o.selectedYear,j=this._restrictMinMax(o,this._determineDate(o,l,new Date()));o.selectedDay=o.currentDay=j.getDate();o.drawMonth=o.selectedMonth=o.currentMonth=j.getMonth();o.drawYear=o.selectedYear=o.currentYear=j.getFullYear();if((k!==o.selectedMonth||m!==o.selectedYear)&&!n){this._notifyChange(o)}this._adjustInstDate(o);if(o.input){o.input.val(i?"":this._formatDate(o))}},_getDate:function(j){var i=(!j.currentYear||(j.input&&j.input.val()==="")?null:this._daylightSavingAdjust(new Date(j.currentYear,j.currentMonth,j.currentDay)));return i},_attachHandlers:function(j){var i=this._get(j,"stepMonths"),k="#"+j.id.replace(/\\\\/g,"\\");j.dpDiv.find("[data-handler]").map(function(){var l={prev:function(){$.datepicker._adjustDate(k,-i,"M")},next:function(){$.datepicker._adjustDate(k,+i,"M")},hide:function(){$.datepicker._hideDatepicker()},today:function(){$.datepicker._gotoToday(k)},selectDay:function(){$.datepicker._selectDay(k,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false},selectMonth:function(){$.datepicker._selectMonthYear(k,this,"M");return false},selectYear:function(){$.datepicker._selectMonthYear(k,this,"Y");return false}};$(this).bind(this.getAttribute("data-event"),l[this.getAttribute("data-handler")])})},_generateHTML:function(Z){var B,A,U,L,m,ad,X,Q,ag,J,ak,t,v,u,j,ac,r,E,af,S,al,D,I,s,n,V,O,R,P,q,G,w,Y,ab,l,ae,ai,N,x,aa=new Date(),C=this._daylightSavingAdjust(new Date(aa.getFullYear(),aa.getMonth(),aa.getDate())),ah=this._get(Z,"isRTL"),aj=this._get(Z,"showButtonPanel"),T=this._get(Z,"hideIfNoPrevNext"),H=this._get(Z,"navigationAsDateFormat"),y=this._getNumberOfMonths(Z),p=this._get(Z,"showCurrentAtPos"),K=this._get(Z,"stepMonths"),F=(y[0]!==1||y[1]!==1),k=this._daylightSavingAdjust((!Z.currentDay?new Date(9999,9,9):new Date(Z.currentYear,Z.currentMonth,Z.currentDay))),o=this._getMinMaxDate(Z,"min"),z=this._getMinMaxDate(Z,"max"),i=Z.drawMonth-p,W=Z.drawYear;if(i<0){i+=12;W--}if(z){B=this._daylightSavingAdjust(new Date(z.getFullYear(),z.getMonth()-(y[0]*y[1])+1,z.getDate()));B=(o&&B<o?o:B);while(this._daylightSavingAdjust(new Date(W,i,1))>B){i--;if(i<0){i=11;W--}}}Z.drawMonth=i;Z.drawYear=W;A=this._get(Z,"prevText");A=(!H?A:this.formatDate(A,this._daylightSavingAdjust(new Date(W,i-K,1)),this._getFormatConfig(Z)));U=(this._canAdjustMonth(Z,-1,W,i)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+A+"'><span class='ui-icon ui-icon-circle-triangle-"+(ah?"e":"w")+"'>"+A+"</span></a>":(T?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+A+"'><span class='ui-icon ui-icon-circle-triangle-"+(ah?"e":"w")+"'>"+A+"</span></a>"));L=this._get(Z,"nextText");L=(!H?L:this.formatDate(L,this._daylightSavingAdjust(new Date(W,i+K,1)),this._getFormatConfig(Z)));m=(this._canAdjustMonth(Z,+1,W,i)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+L+"'><span class='ui-icon ui-icon-circle-triangle-"+(ah?"w":"e")+"'>"+L+"</span></a>":(T?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+L+"'><span class='ui-icon ui-icon-circle-triangle-"+(ah?"w":"e")+"'>"+L+"</span></a>"));ad=this._get(Z,"currentText");X=(this._get(Z,"gotoCurrent")&&Z.currentDay?k:C);ad=(!H?ad:this.formatDate(ad,X,this._getFormatConfig(Z)));Q=(!Z.inline?"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(Z,"closeText")+"</button>":"");ag=(aj)?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(ah?Q:"")+(this._isInRange(Z,X)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+ad+"</button>":"")+(ah?"":Q)+"</div>":"";J=parseInt(this._get(Z,"firstDay"),10);J=(isNaN(J)?0:J);ak=this._get(Z,"showWeek");t=this._get(Z,"dayNames");v=this._get(Z,"dayNamesMin");u=this._get(Z,"monthNames");j=this._get(Z,"monthNamesShort");ac=this._get(Z,"beforeShowDay");r=this._get(Z,"showOtherMonths");E=this._get(Z,"selectOtherMonths");af=this._getDefaultDate(Z);S="";al;for(D=0;D<y[0];D++){I="";this.maxRows=4;for(s=0;s<y[1];s++){n=this._daylightSavingAdjust(new Date(W,i,Z.selectedDay));V=" ui-corner-all";O="";if(F){O+="<div class='ui-datepicker-group";if(y[1]>1){switch(s){case 0:O+=" ui-datepicker-group-first";V=" ui-corner-"+(ah?"right":"left");break;case y[1]-1:O+=" ui-datepicker-group-last";V=" ui-corner-"+(ah?"left":"right");break;default:O+=" ui-datepicker-group-middle";V="";break}}O+="'>"}O+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+V+"'>"+(/all|left/.test(V)&&D===0?(ah?m:U):"")+(/all|right/.test(V)&&D===0?(ah?U:m):"")+this._generateMonthYearHeader(Z,i,W,o,z,D>0||s>0,u,j)+"</div><table class='ui-datepicker-calendar'><thead><tr>";R=(ak?"<th class='ui-datepicker-week-col'>"+this._get(Z,"weekHeader")+"</th>":"");for(al=0;al<7;al++){P=(al+J)%7;R+="<th scope='col'"+((al+J+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+t[P]+"'>"+v[P]+"</span></th>"}O+=R+"</tr></thead><tbody>";q=this._getDaysInMonth(W,i);if(W===Z.selectedYear&&i===Z.selectedMonth){Z.selectedDay=Math.min(Z.selectedDay,q)}G=(this._getFirstDayOfMonth(W,i)-J+7)%7;w=Math.ceil((G+q)/7);Y=(F?this.maxRows>w?this.maxRows:w:w);this.maxRows=Y;ab=this._daylightSavingAdjust(new Date(W,i,1-G));for(l=0;l<Y;l++){O+="<tr>";ae=(!ak?"":"<td class='ui-datepicker-week-col'>"+this._get(Z,"calculateWeek")(ab)+"</td>");for(al=0;al<7;al++){ai=(ac?ac.apply((Z.input?Z.input[0]:null),[ab]):[true,""]);N=(ab.getMonth()!==i);x=(N&&!E)||!ai[0]||(o&&ab<o)||(z&&ab>z);ae+="<td class='"+((al+J+6)%7>=5?" ui-datepicker-week-end":"")+(N?" ui-datepicker-other-month":"")+((ab.getTime()===n.getTime()&&i===Z.selectedMonth&&Z._keyEvent)||(af.getTime()===ab.getTime()&&af.getTime()===n.getTime())?" "+this._dayOverClass:"")+(x?" "+this._unselectableClass+" ui-state-disabled":"")+(N&&!r?"":" "+ai[1]+(ab.getTime()===k.getTime()?" "+this._currentClass:"")+(ab.getTime()===C.getTime()?" ui-datepicker-today":""))+"'"+((!N||r)&&ai[2]?" title='"+ai[2].replace(/'/g,"&#39;")+"'":"")+(x?"":" data-handler='selectDay' data-event='click' data-month='"+ab.getMonth()+"' data-year='"+ab.getFullYear()+"'")+">"+(N&&!r?"&#xa0;":(x?"<span class='ui-state-default'>"+ab.getDate()+"</span>":"<a class='ui-state-default"+(ab.getTime()===C.getTime()?" ui-state-highlight":"")+(ab.getTime()===k.getTime()?" ui-state-active":"")+(N?" ui-priority-secondary":"")+"' href='#'>"+ab.getDate()+"</a>"))+"</td>";ab.setDate(ab.getDate()+1);ab=this._daylightSavingAdjust(ab)}O+=ae+"</tr>"}i++;if(i>11){i=0;W++}O+="</tbody></table>"+(F?"</div>"+((y[0]>0&&s===y[1]-1)?"<div class='ui-datepicker-row-break'></div>":""):"");I+=O}S+=I}S+=ag;Z._keyEvent=false;return S},_generateMonthYearHeader:function(m,k,u,o,s,v,q,i){var z,j,A,x,n,w,t,p,l=this._get(m,"changeMonth"),B=this._get(m,"changeYear"),C=this._get(m,"showMonthAfterYear"),r="<div class='ui-datepicker-title'>",y="";if(v||!l){y+="<span class='ui-datepicker-month'>"+q[k]+"</span>"}else{z=(o&&o.getFullYear()===u);j=(s&&s.getFullYear()===u);y+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(A=0;A<12;A++){if((!z||A>=o.getMonth())&&(!j||A<=s.getMonth())){y+="<option value='"+A+"'"+(A===k?" selected='selected'":"")+">"+i[A]+"</option>"}}y+="</select>"}if(!C){r+=y+(v||!(l&&B)?"&#xa0;":"")}if(!m.yearshtml){m.yearshtml="";if(v||!B){r+="<span class='ui-datepicker-year'>"+u+"</span>"}else{x=this._get(m,"yearRange").split(":");n=new Date().getFullYear();w=function(E){var D=(E.match(/c[+\-].*/)?u+parseInt(E.substring(1),10):(E.match(/[+\-].*/)?n+parseInt(E,10):parseInt(E,10)));return(isNaN(D)?n:D)};t=w(x[0]);p=Math.max(t,w(x[1]||""));t=(o?Math.max(t,o.getFullYear()):t);p=(s?Math.min(p,s.getFullYear()):p);m.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;t<=p;t++){m.yearshtml+="<option value='"+t+"'"+(t===u?" selected='selected'":"")+">"+t+"</option>"}m.yearshtml+="</select>";r+=m.yearshtml;m.yearshtml=null}}r+=this._get(m,"yearSuffix");if(C){r+=(v||!(l&&B)?"&#xa0;":"")+y}r+="</div>";return r},_adjustInstDate:function(l,o,n){var k=l.drawYear+(n==="Y"?o:0),m=l.drawMonth+(n==="M"?o:0),i=Math.min(l.selectedDay,this._getDaysInMonth(k,m))+(n==="D"?o:0),j=this._restrictMinMax(l,this._daylightSavingAdjust(new Date(k,m,i)));l.selectedDay=j.getDate();l.drawMonth=l.selectedMonth=j.getMonth();l.drawYear=l.selectedYear=j.getFullYear();if(n==="M"||n==="Y"){this._notifyChange(l)}},_restrictMinMax:function(l,j){var k=this._getMinMaxDate(l,"min"),m=this._getMinMaxDate(l,"max"),i=(k&&j<k?k:j);return(m&&i>m?m:i)},_notifyChange:function(j){var i=this._get(j,"onChangeMonthYear");if(i){i.apply((j.input?j.input[0]:null),[j.selectedYear,j.selectedMonth+1,j])}},_getNumberOfMonths:function(j){var i=this._get(j,"numberOfMonths");return(i==null?[1,1]:(typeof i==="number"?[1,i]:i))},_getMinMaxDate:function(j,i){return this._determineDate(j,this._get(j,i+"Date"),null)},_getDaysInMonth:function(i,j){return 32-this._daylightSavingAdjust(new Date(i,j,32)).getDate()},_getFirstDayOfMonth:function(i,j){return new Date(i,j,1).getDay()},_canAdjustMonth:function(l,n,k,m){var i=this._getNumberOfMonths(l),j=this._daylightSavingAdjust(new Date(k,m+(n<0?n:i[0]*i[1]),1));if(n<0){j.setDate(this._getDaysInMonth(j.getFullYear(),j.getMonth()))}return this._isInRange(l,j)},_isInRange:function(m,k){var j,p,l=this._getMinMaxDate(m,"min"),i=this._getMinMaxDate(m,"max"),q=null,n=null,o=this._get(m,"yearRange");if(o){j=o.split(":");p=new Date().getFullYear();q=parseInt(j[0],10);n=parseInt(j[1],10);if(j[0].match(/[+\-].*/)){q+=p}if(j[1].match(/[+\-].*/)){n+=p}}return((!l||k.getTime()>=l.getTime())&&(!i||k.getTime()<=i.getTime())&&(!q||k.getFullYear()>=q)&&(!n||k.getFullYear()<=n))},_getFormatConfig:function(i){var j=this._get(i,"shortYearCutoff");j=(typeof j!=="string"?j:new Date().getFullYear()%100+parseInt(j,10));return{shortYearCutoff:j,dayNamesShort:this._get(i,"dayNamesShort"),dayNames:this._get(i,"dayNames"),monthNamesShort:this._get(i,"monthNamesShort"),monthNames:this._get(i,"monthNames")}},_formatDate:function(l,i,m,k){if(!i){l.currentDay=l.selectedDay;l.currentMonth=l.selectedMonth;l.currentYear=l.selectedYear}var j=(i?(typeof i==="object"?i:this._daylightSavingAdjust(new Date(k,m,i))):this._daylightSavingAdjust(new Date(l.currentYear,l.currentMonth,l.currentDay)));return this.formatDate(this._get(l,"dateFormat"),j,this._getFormatConfig(l))}});function b(j){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return j.delegate(i,"mouseout",function(){$(this).removeClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){$(this).removeClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){$(this).removeClass("ui-datepicker-next-hover")}}).delegate(i,"mouseover",f)}function f(){if(!$.datepicker._isDisabledDatepicker(g.inline?g.dpDiv.parent()[0]:g.input[0])){$(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");$(this).addClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){$(this).addClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){$(this).addClass("ui-datepicker-next-hover")}}}function a(k,j){$.extend(k,j);for(var i in j){if(j[i]==null){k[i]=j[i]}}return k}$.fn.datepicker=function(j){if(!this.length){return this}if(!$.datepicker.initialized){$(document).mousedown($.datepicker._checkExternalClick);$.datepicker.initialized=true}if($("#"+$.datepicker._mainDivId).length===0){$("body").append($.datepicker.dpDiv)}var i=Array.prototype.slice.call(arguments,1);if(typeof j==="string"&&(j==="isDisabled"||j==="getDate"||j==="widget")){return $.datepicker["_"+j+"Datepicker"].apply($.datepicker,[this[0]].concat(i))}if(j==="option"&&arguments.length===2&&typeof arguments[1]==="string"){return $.datepicker["_"+j+"Datepicker"].apply($.datepicker,[this[0]].concat(i))}return this.each(function(){typeof j==="string"?$.datepicker["_"+j+"Datepicker"].apply($.datepicker,[this].concat(i)):$.datepicker._attachDatepicker(this,j)})};$.datepicker=new c();$.datepicker.initialized=false;$.datepicker.uuid=new Date().getTime();$.datepicker.version="1.11.3";var e=$.datepicker;return e});M.define("DateRangePicker",function(d){var b=d("xdate");d("jqui-datepicker");var a={duration:50,numberOfMonths:2,altFormat:"yy-mm-dd",dateFormat:"yy-mm-dd",dayNamesMin:["日","一","二","三","四","五","六"],dayNamesShort:["日","一","二","三","四","五","六"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]};var c=function(f){this.dateFormat="yyyy-MM-dd";this.timer=null;this.customCss="hotel_datepicker";this.startInput=null;this.endInput=null;this.startDate=null;this.endDate=null;this.minDate=null;this.maxDate=null;this.rangeMinDays=1;this.rangeMaxDays=null;this.datePickerOptions={};this.startDayClass="start_day";this.startDayClassUnset="start_day_unset";this.endDayClass="end_day";this.endDayClassUnset="end_day_unset";M.mix(this,f);M.mix(this.datePickerOptions,a,false);this.startInput=$(this.startInput);this.endInput=$(this.endInput);this.dateRangeSetted=true;this.showIns=null;this.preCheck();this.init()};c.prototype={init:function(){this.initDatePicker()},preCheck:function(){if(!this.startInput.length||!this.endInput.length){M.error("date range picker need an start input and an end input")}if(this.maxDate&&this.minDate&&b.parse(this.maxDate)<=b.parse(this.minDate)){M.error("max date must big than min date")}this.rangeMinDays=+this.rangeMinDays;if(isNaN(this.rangeMinDays)||this.rangeMinDays<0){M.error("date range days must be positive")}if(this.rangeMaxDays){this.rangeMaxDays=+this.rangeMaxDays;if(isNaN(this.rangeMaxDays)||this.rangeMaxDays<0){M.error("date range days must be positive")}}if(this.rangeMinDays&&this.rangeMaxDays&&this.rangeMinDays>this.rangeMaxDays){M.error("date range max days must equal or more than min days")}if(this.maxDate&&this.minDate&&this.rangeMinDays>0){var g=new b(this.minDate);var i=new b(this.maxDate);if(g.diffDays(i)<this.rangeMinDays){M.error("date range days must equal or more than range min days")}}if(!this.startDate){this.startDate=(new b()).toString(this.dateFormat)}if(this.minDate&&b.parse(this.startDate)<b.parse(this.minDate)){this.startDate=this.minDate}if(this.endDate){var f=new b(this.startDate),h=new b(this.endDate);if(f.diffDays(h)<this.rangeMinDays){h=f.addDays(this.rangeMinDays)}if(this.maxDate&&b.parse(this.maxDate)<h){h=this.maxDate}this.endDate=h.toString(this.dateFormat)}else{this.endDate=(new b(this.startDate)).addDays(1).toString(this.dateFormat)}M.debug("fix start and end date as:"+this.startDate+", "+this.endDate)},initDatePicker:function(){var g={onSelect:M.bind(this.selectDate,this),onClose:M.bind(this.closeDate,this),beforeShow:M.bind(this.beforeShow,this),beforeShowDay:M.bind(this.beforeShowDay,this)},h=M.mix({},g,a),f=M.mix({},g,a);if(this.minDate){h.minDate=(new b(this.minDate)).toString(this.dateFormat);f.minDate=(new b(this.minDate)).addDays(this.rangeMinDays).toString(this.dateFormat)}if(this.maxDate){h.maxDate=(new b(this.maxDate)).addDays(-this.rangeMinDays).toString(this.dateFormat);f.maxDate=(new b(this.startDate)).addDays(this.rangeMaxDays).toString(this.dateFormat)}this.startInput.datepicker(h);this.endInput.datepicker(f)}};var e={};M.mix(c.prototype,{selectDate:function(g,h){var j="",i={startDate:this.startDate,endDate:this.endDate};if(h.input.is(this.startInput)){i.startDate=g;j=this.endInput}else{i.endDate=g;j=this.startInput}if(h.input.is(this.startInput)){j.datepicker("option","maxDate",(new b(g)).addDays(this.rangeMaxDays).toString(this.dateFormat));if(this.rangeMaxDays&&b.parse(i.endDate)-b.parse(g)>this.rangeMaxDays*24*60*60*1000){i.endDate=(new b(g)).addDays(this.rangeMinDays).toString(this.dateFormat);j.datepicker("setDate",i.endDate);setTimeout(M.bind(function(){this.dateRangeSetted=false;j.datepicker("show")},this),100)}}if(b.parse(i.startDate)>=b.parse(i.endDate)){var f="";if(h.input.is(this.startInput)){f=(new b(i.startDate)).addDays(this.rangeMinDays).toString(this.dateFormat);i.endDate=f}else{f=(new b(i.endDate)).addDays(-this.rangeMinDays).toString(this.dateFormat);i.startDate=f}j.datepicker("setDate",f);if(this.dateRangeSetted){setTimeout(M.bind(function(){this.dateRangeSetted=false;j.datepicker("show")},this),100)}else{this.dateRangeSetted=true}}else{this.dateRangeSetted=true}if(!(i.startDate==this.startDate&&i.endDate==this.endDate)){this.startDate=i.startDate;this.endDate=i.endDate;M.Event(this).fire("date range picker changed",i)}},setDate:function(f){this.startDate=f.startDate;this.endDate=f.endDate;this.preCheck();this.startInput.datepicker("setDate",f.startDate);this.endInput.datepicker("setDate",f.endDate)},closeDate:function(g,h){var f=this;this.timer=setTimeout(function(){$("#ui-datepicker-div").removeClass(f.customCss)},1000);if(!this.dateRangeSetted){this.dateRangeSetted=true}},beforeShow:function(f,g){clearTimeout(this.timer);$("#ui-datepicker-div").addClass(this.customCss);this.showIns=g},beforeShowDay:function(h){var i=b.parse(this.startDate),g=b.parse(this.endDate),f=b.parse(h);var j=f==i?this.startDayClass:(f>i&&f<g?"range_day":(f==g?this.endDayClass:""));if(!this.dateRangeSetted){if(this.showIns.id==this.startInput.attr("id")){j=j==this.endDayClass?this.endDayClassUnset:""}else{j=j==this.startDayClass?this.startDayClassUnset:""}}return[true,j]}});return c});
/*!
 * jQuery Templates Plugin 1.0.0pre
 * http://github.com/jquery/jquery-tmpl
 * Requires jQuery 1.4.2
 *
 * Copyright 2011, Software Freedom Conservancy, Inc.
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
(function(i,f){var t=i.fn.domManip,h="_tmplitem",u=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,p={},e={},y,x={key:0,data:{}},w=0,q=0,g=[];function k(B,A,D,E){var C={data:E||(E===0||E===false)?E:(A?A.data:{}),_wrap:A?A._wrap:null,tmpl:null,parent:A||null,nodes:[],calls:c,nest:b,wrap:n,html:r,update:z};if(B){i.extend(C,B,{nodes:[],parent:A})}if(D){C.tmpl=D;C._ctnt=C._ctnt||C.tmpl(i,C);C.key=++w;(g.length?e:p)[w]=C}return C}i.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(A,B){i.fn[A]=function(C){var F=[],I=i(C),E,G,D,J,H=this.length===1&&this[0].parentNode;y=p||{};if(H&&H.nodeType===11&&H.childNodes.length===1&&I.length===1){I[B](this[0]);F=this}else{for(G=0,D=I.length;G<D;G++){q=G;E=(G>0?this.clone(true):this).get();i(I[G])[B](E);F=F.concat(E)}q=0;F=this.pushStack(F,A,I.selector)}J=y;y=null;i.tmpl.complete(J);return F}});i.fn.extend({tmpl:function(C,B,A){return i.tmpl(this[0],C,B,A)},tmplItem:function(){return i.tmplItem(this[0])},template:function(A){return i.template(A,this[0])},domManip:function(E,H,G,I){if(E[0]&&i.isArray(E[0])){var B=i.makeArray(arguments),A=E[0],F=A.length,C=0,D;while(C<F&&!(D=i.data(A[C++],"tmplItem"))){}if(D&&q){B[2]=function(J){i.tmpl.afterManip(this,J,G)}}t.apply(this,B)}else{t.apply(this,arguments)}q=0;if(!y){i.tmpl.complete(p)}return this}});i.extend({tmpl:function(C,F,E,B){var D,A=!B;if(A){B=x;C=i.template[C]||i.template(null,C);e={}}else{if(!C){C=B.tmpl;p[B.key]=B;B.nodes=[];if(B.wrapped){s(B,B.wrapped)}return i(m(B,null,B.tmpl(i,B)))}}if(!C){return[]}if(typeof F==="function"){F=F.call(B||{})}if(E&&E.wrapped){s(E,E.wrapped)}D=i.isArray(F)?i.map(F,function(G){return G?k(E,B,C,G):null}):[k(E,B,C,F)];return A?i(m(B,null,D)):D},tmplItem:function(B){var A;if(B instanceof i){B=B[0]}while(B&&B.nodeType===1&&!(A=i.data(B,"tmplItem"))&&(B=B.parentNode)){}return A||x},template:function(B,A){if(A){if(typeof A==="string"){A=l(A)}else{if(A instanceof i){A=A[0]||{}}}if(A.nodeType){A=i.data(A,"tmpl")||i.data(A,"tmpl",l(A.innerHTML))}return typeof B==="string"?(i.template[B]=A):A}return B?(typeof B!=="string"?i.template(null,B):(i.template[B]||i.template(null,u.test(B)?B:i(B)))):null},encode:function(A){return(""+A).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});i.extend(i.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(A){p={}},afterManip:function v(C,A,D){var B=A.nodeType===11?i.makeArray(A.childNodes):A.nodeType===1?[A]:[];D.call(C,A);o(B);q++}});function m(A,E,C){var D,B=C?i.map(C,function(F){return(typeof F==="string")?(A.key?F.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+h+'="'+A.key+'" $2'):F):m(F,A,F._ctnt)}):A;if(E){return B}B=B.join("");B.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(G,H,F,I){D=i(F).get();o(D);if(H){D=a(H).concat(D)}if(I){D=D.concat(a(I))}});return D?D:a(B)}function a(B){var A=document.createElement("div");A.innerHTML=B;return i.makeArray(A.childNodes)}function l(A){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+i.trim(A).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(I,C,G,D,E,J,F){var L=i.tmpl.tag[G],B,H,K;if(!L){throw"Unknown template tag: "+G}B=L._default||[];if(J&&!/\w$/.test(E)){E+=J;J=""}if(E){E=j(E);F=F?(","+j(F)+")"):(J?")":"");H=J?(E.indexOf(".")>-1?E+j(J):("("+E+").call($item"+F)):E;K=J?H:"(typeof("+E+")==='function'?("+E+").call($item):("+E+"))"}else{K=H=B.$1||"null"}D=j(D);return"');"+L[C?"close":"open"].split("$notnull_1").join(E?"typeof("+E+")!=='undefined' && ("+E+")!=null":"true").split("$1a").join(K).split("$1").join(H).split("$2").join(D||B.$2||"")+"__.push('"})+"');}return __;")}function s(B,A){B._wrap=m(B,true,i.isArray(A)?A:[u.test(A)?A:i(A).html()]).join("")}function j(A){return A?A.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function d(A){var B=document.createElement("div");B.appendChild(A.cloneNode(true));return B.innerHTML}function o(G){var I="_"+q,B,A,E={},F,D,C;for(F=0,D=G.length;F<D;F++){if((B=G[F]).nodeType!==1){continue}A=B.getElementsByTagName("*");for(C=A.length-1;C>=0;C--){H(A[C])}H(B)}function H(P){var L,O=P,N,J,K;if((K=P.getAttribute(h))){while(O.parentNode&&(O=O.parentNode).nodeType===1&&!(L=O.getAttribute(h))){}if(L!==K){O=O.parentNode?(O.nodeType===11?0:(O.getAttribute(h)||0)):0;if(!(J=p[K])){J=e[K];J=k(J,p[O]||e[O]);J.key=++w;p[w]=J}if(q){Q(K)}}P.removeAttribute(h)}else{if(q&&(J=i.data(P,"tmplItem"))){Q(J.key);p[J.key]=J;O=i.data(P.parentNode,"tmplItem");O=O?O.key:0}}if(J){N=J;while(N&&N.key!=O){N.nodes.push(P);N=N.parent}delete J._ctnt;delete J._wrap;i.data(P,"tmplItem",J)}function Q(R){R=R+I;J=E[R]=(E[R]||k(J,p[J.parent.key+I]||J.parent))}}}function c(C,A,D,B){if(!C){return g.pop()}g.push({_:C,tmpl:A,item:this,data:D,options:B})}function b(A,C,B){return i.tmpl(i.template(A),C,B,this)}function n(C,A){var B=C.options||{};B.wrapped=A;return i.tmpl(i.template(C.tmpl),C.data,B,C.item)}function r(B,C){var A=this._wrap;return i.map(i(i.isArray(A)?A.join(""):A).filter(B||"*"),function(D){return C?D.innerText||D.textContent:D.outerHTML||d(D)})}function z(){var A=this.nodes;i.tmpl(null,null,null,this).insertBefore(A[0]);i(A).remove()}if(window.M&&typeof M.define=="function"){M.define("jq-tmpl",function(){return i})}})(jQuery);M.define("Pagination",function(b,a,c){b("jq-tmpl");function d(e){this.total=null;this.pageSize=null;this.currPage=null;this.pageDisplayNum=null;this.callback=null;this.tmpl=null;this.container=null;this.pageItemClass="_j_pageitem";this.jumperBtnClass="_j_jumperbtn";this.jumperInputClass="_j_jumperinput";this.loadInitPage=false;this.evenOffset=-1;M.mix(this,e);this.total=+this.total;this.pageSize=this.pageSize>0?(+this.pageSize):10;this.currPage=this.currPage>0?(+this.currPage):1;this.pageDisplayNum=this.pageDisplayNum>0?(+this.pageDisplayNum):5;this.container=$(this.container);if(this.total<0||!this.tmpl.length||!this.container.length){M.error("pagination param invalid")}this.init()}M.mix(d.prototype,{init:function(){if(this.loadInitPage){this.loadPage(this.currPage)}else{this.drawPage()}this.bindEvents()},drawPage:function(){var g={total:this.total,currPage:this.currPage,pageSize:this.pageSize,pageDisplayNum:this.pageDisplayNum};var e=Math.ceil(this.total/this.pageSize);g.pageTotal=e;if(e<=this.pageDisplayNum){g.indexers=this.makeIndex(1,e)}else{if(this.currPage>e){this.currPage=e}var f=(this.pageDisplayNum-1)/2;if(f!==parseInt(f,10)){f=this.evenOffset>0?Math.floor(f)+this.evenOffset:Math.ceil(f)+this.evenOffset}var h=this.pageDisplayNum-1-f;if(this.currPage-f<1){f=this.currPage-1;h=this.pageDisplayNum-1-f}else{if(this.currPage+h>e){h=e-this.currPage;f=this.pageDisplayNum-1-h}}g.indexers=this.makeIndex(this.currPage-f,this.pageDisplayNum)}this.container.empty().append($(this.tmpl).tmpl(g))},loadPage:function(e){this.currPage=e;this.drawPage();if(typeof this.callback=="function"){this.callback(e)}},bindEvents:function(){this.container.undelegate("click");this.container.undelegate("keydown");this.container.on("click","."+this.pageItemClass,M.bind(function(f){var g=$(f.currentTarget),e=g.data("page");this.loadPage(e);f.preventDefault()},this));this.container.on("click","."+this.jumperBtnClass,M.bind(function(f){var g=$(f.currentTarget),e=+this.container.find("."+this.jumperInputClass).val();f.preventDefault();if(e<=0||e>Math.ceil(this.total/this.pageSize)){alert("请输入有效的页码");return false}this.loadPage(e)},this));this.container.on("keydown","."+this.jumperInputClass,M.bind(function(e){if(e.keyCode==13){this.container.find("."+this.jumperBtnClass).trigger("click")}},this))},makeIndex:function(h,f){var e=[];for(var g=h;g<h+f;g++){e.push(g)}return e}});c.exports=d});M.closure(function(an){var o=an("Slider"),aq=an("/js/Dropdown"),e=an("ScrollBar"),R=an("Suggestion"),O=an("Cookie"),af=an("xdate"),az=an("DateRangePicker");var ac=600,aw=5000,aB=false,G=$("#_j_top_pic_container"),ae=G.find(".show-image"),ab=G.find(".show-nav"),J=ae.children("li"),x=J.length;function S(){var aE=$(window).width(),aD=Math.round(aE/3);G.height(aD);ae.find("img").each(function(aG,aI){var aH=$(aI),aF=parseInt(aH.css("height"),10);if(aF>aD){aH.css("marginTop",-Math.round((aF-aD)/2))}})}S();$(window).on("resize",S);var at=new o({slideCnt:ae,slideList:J,slideTime:ac,indexer:ab.children("li"),indexerOnClass:"active",shStyle:"fadeInOut"});ae.add(ab).bind("mouseenter",function(){aB=true}).bind("mouseleave",function(){aB=false});setInterval(function(){if(!aB&&M.windowFocused){if(at.index<x){at.toIndex(at.index+1)}else{at.toIndex(1)}}},aw);var ag=$("#_j_index_search"),aa=$("#_j_index_search_tab"),L=$("#_j_index_search_bar_all"),g=$("#_j_index_search_bar_hotel"),I=$("#_j_index_search_bar_mdd"),au=$("#_j_index_search_bar_sales");aa.on("click","li",function(aD){var aF=$(aD.currentTarget),aE=Number(aF.data("val"));aa.find("li").removeClass("tab-selected");aF.addClass("tab-selected");ag.find(".searchbar").hide();switch(aE){case 0:L.show();break;case 1:g.show();break;case 2:I.show();break;case 3:au.show();break;default:}});var Y=true;var h=function(aE,aI,aH,aG,aF){var aD={};if(aI=="hotel"){aD.url="/hotel/s.php?q="+encodeURIComponent(aE)}else{if(aI=="sales"){aD.url="/sales/0-0-K"+encodeURIComponent(aE)+"-0.html"}else{aD.url="/group/s.php?q="+encodeURIComponent(aE)}}aD.search_type="all";aD.search_category="suggest";aD.trigger=aG;aD.search_from="index_"+aI;aD.keyword=aE;if(aH.length){aD.url=aH.data("url");aD.search_type=aH.data("type")}aD.trigger=aD.search_type=="more"?"more":aD.trigger;if(aD.trigger!="enter"){Y=false}!!mfwPageEvent&&mfwPageEvent("se","result_click",aD)};var ap=$("#_j_index_suggest_input_all"),ar=$("#_j_index_suggest_btn_all"),av=$("#_j_index_suggest_list_all"),p=$("#_j_index_search_bar_all form");var q=new R({url:"/group/ss.php",input:ap,listItemHoverClass:"active",dataType:"json",listContainer:av,handleSuggest:function(aG){var aE=aG.data?z(aG.data,$.trim(ap.val())):[];ap.data("droplist")["firstItemHover"]=aG.exact==true;if(!aE.length){ap.data("droplist").hide()}else{var aD=[];for(var aF=0;aF<aE.length;aF++){if(aE[aF]=="search://"){if(aE[aF+1]=="more"){aD.push('<li class="ssp-more _j_listitem" data-type="'+aE[aF+1]+'" data-url="http://'+Env.WWW_HOST+aE[aF+2]+'" data-title="'+aE[aF+4]+'">'+aE[aF+6]+"</li>")}else{aD.push('<li class="_j_listitem" data-type="'+aE[aF+1]+'" data-url="http://'+Env.WWW_HOST+aE[aF+2]+'" data-title="'+aE[aF+4]+'"><i class="'+aE[aF+3]+'"></i><span class="skey">'+aE[aF+6]+"</span><span>"+aE[aF+5]+"</span></li>")}aF+=6}else{aD.push("<li>"+aE[aF]+"</li>")}}return aD.join("")}},updateList:function(aD){this.listContainer.find(".suggest-list").html(aD)}});p.on("submit",function(){if(Y==false){return false}h($.trim(ap.val()),"all","","enter")});M.Event(q).on("itemselected",function(aD){var aE=aD.item;if(aE.length){h($.trim(ap.val()),"all",aE,"click");location.href=aE.data("url")}else{if(ap.parents("form").length){ap.parents("form").last().submit()}else{return}}});ar.click(function(aE){var aD=$.trim(ap.val());if(!!aD){h(aD,"all","","search_btn");location.href="/group/s.php?q="+encodeURIComponent(aD)}});function z(aE,aI){var aF=[],aK=aE.split("|");aI=f(aI);for(var aH=0;aH<aK.length;aH++){var aG=$.trim(aK[aH]);if(aG=="search://"){var aD=aF.length;aF[aD]=aK[aH++];aF[aD+1]=aK[aH++];aF[aD+2]=aK[aH++];aF[aD+3]=aK[aH++];aF[aD+4]=aK[aH++];aF[aD+5]=aK[aH];continue}if(aG){try{aG=aG.replace(new RegExp(aI,"ig"),function(aL){return'<span class="highlight">'+aL+"</span>"})}catch(aJ){aG=aG.replace(aI,function(aL){return'<span class="highlight">'+aL+"</span>"})}aF[aF.length]=aG}}return aF}var W=$("<div/>");function f(aD){return W.text(aD).html()}var j=$("#_j_check_in"),v=$("#_j_check_out"),N=j.find("input"),aA=v.find("input"),k=j.find("span"),a=v.find("span"),t=window.pageVar.checkIn,E=window.pageVar.checkOut,H=new af();N.val(t);aA.val(E);k.html(t);a.html(E);var U=new az({startInput:N,endInput:aA,startDate:t,endDate:E,minDate:H.toString("yyyy-MM-dd"),maxDate:H.addYears(1).toString("yyyy-MM-dd"),rangeMaxDays:30,customCss:"hotel_datepicker"});j.on("click",function(aD){N.datepicker("show")});v.on("click",function(aD){aA.datepicker("show")});M.Event(U).on("date range picker changed",function(aD){k.html(aD.startDate);a.html(aD.endDate);O.set("check_in",aD.startDate,{path:"/",domain:"mafengwo.cn"});O.set("check_out",aD.endDate,{path:"/",domain:"mafengwo.cn"})});var ay=$("#_j_index_suggest_input_hotel"),d=$("#_j_index_suggest_btn_hotel"),u=$("#_j_index_suggest_list_hotel"),c=$("#_j_index_search_bar_hotel form");var A=new R({url:"/hotel/ajax.php?sAction=getSuggestList",input:ay,keyParamName:"keyword",listItemHoverClass:"active",dataType:"json",listContainer:u,handleSuggest:function(aF){ay.data("droplist")["firstItemHover"]=true;var aD=$.trim(ay.val()),aE=s(aF.place,"place",aD)+s(aF.station,"station",aD)+s(aF.railway_station,"railway_station ",aD)+s(aF.airport,"airport",aD)+s(aF.scenic,"scenic",aD)+s(aF.hotel,"hotel",aD);if(!aE.length){ay.data("droplist").hide()}else{aE+='<a class="ssp-more _j_listitem" data-type="more" href="javascript:;" data-url="http://'+Env.WWW_HOST+"/hotel/s.php?sKeyWord="+aD+'">查看“<b>'+aD+"</b>”更多搜索结果</a>";return aE}},updateList:function(aD){this.listContainer.html(aD)}});function s(aM,aP,aL){var aI=$("<dl>"),aE=[],aO={place:"sicon-place",station:"sicon-metro",railway_station:"sicon-train",airport:"sicon-airport",scenic:"sicon-scenic",hotel:"sicon-hotel"};if(!!aM&&aM.length>0){for(var aJ=0;aJ<aM.length;aJ++){var aF=aM[aJ].id,aK=aM[aJ].cname_for_display,aH=aM[aJ].ename_for_display,aR=aM[aJ].parent_str,aQ=aM[aJ].type,aG=$('<a href="javascript:;">'),aD,aN=(aP==="hotel")?"":aM[aJ].hotel_num+"家酒店";switch(aP){case"place":if(aQ==="mdd"){aD="/hotel/"+aF+"/"}if(aQ==="district"){aD="/hotel/area_"+aF+".html"}break;case"hotel":aD="/hotel/"+aF+".html";break;default:aD="/hotel/jd"+aF+".html";break}aG.attr("data-name",aK+" "+aH);if(aL.length>0){aK=aK.replace(new RegExp("("+aL+"{1})","gi"),"<b>$1</b>");aH=aH.replace(new RegExp("("+aL+"{1})","gi"),"<b>$1</b>")}aG.append('<span class="nums">'+aN+"</span>").append('<h4><span class="skey">'+aK+'</span><span class="en">'+aH+"</span></h4>").append("<p>"+aR+"</p>");aE.push('<dd class="_j_listitem" data-type="hotel" data-url="'+aD+'">'+aG[0].outerHTML+"</dd>")}aI.append('<dt><i class="'+aO[aP]+'"></i></dt>');aI.append(aE.join(""));return aI[0].outerHTML}else{return""}}M.Event(A).on("itemselected",function(aD){var aE=aD.item;if(aE.length){h($.trim(ay.val()),"hotel",aE,"click");location.href=aE.data("url")}else{if(ay.parents("form").length){ay.parents("form").last().submit()}else{return}}});d.click(function(aE){var aD=$.trim(ay.val());if(!!aD){h(aD,"hotel","","search_btn");location.href="/hotel/s.php?sKeyWord="+encodeURIComponent(aD)}});c.on("submit",function(){if(Y==false){return false}h($.trim(ay.val()),"hotel","","enter")});var ai=$("#_j_index_suggest_input_mdd"),ak=$("#_j_index_suggest_btn_mdd"),al=$("#_j_index_suggest_list_mdd"),n=$("#_j_index_search_bar_mdd form");var m=new R({url:"/ajax/router.php?sAct=KMdd_StructWebAjax|SearchMdd",input:ai,keyParamName:"sName",listItemHoverClass:"active",dataType:"json",listContainer:al,handleSuggest:function(aJ){ai.data("droplist")["firstItemHover"]=aJ.data.exact;var aF=$.trim(ai.val());if(!aJ.data.mdd.length){ai.data("droplist").hide()}else{var aE=aJ.data.mdd,aH=[];for(var aI=0,aD=aE.length,aK="";aI<aD;aI++){var aG="/travel-scenic-spot/mafengwo/"+aE[aI].mddid+".html";aH.push('<li class="_j_listitem" data-type="mdd" data-url="'+aG+'"><i class="sicon-place"></i><span class="skey">'+aE[aI].name+"</span>"+(aE[aI].parent?("<span>"+aE[aI].parent+"</span>"):"")+"</li>")}return aH.join("")}},updateList:function(aD){this.listContainer.find(".suggest-list").html(aD)}});M.Event(m).on("itemselected",function(aD){var aE=aD.item;if(aE.length){h($.trim(ai.val()),"mdd",aE,"click");location.href=aE.data("url")}else{if(ai.parents("form").length){ai.parents("form").last().submit()}else{return}}});ak.click(function(aE){var aD=$.trim(ai.val());if(!!aD){h(aD,"mdd","","search_btn");location.href="/group/s.php?q="+encodeURIComponent(aD)}});n.on("submit",function(){if(Y==false){return false}h($.trim(ai.val()),"mdd","","enter")});var V=$("#_j_index_suggest_input_sales"),am=$("#_j_index_suggest_btn_sales");am.click(function(aE){var aD=$.trim(V.val());if(!!aD){h(aD,"sales","","search_btn");location.href="/sales/0-0-K"+encodeURIComponent(aD)+"-0.html"}});var F=$("#_j_traveller_slide"),ad=F.find(".slide-ul"),y=ad.children("li"),ao=y.length,X=F.find(".slide-ol li"),aj=300,D=10000;var b=new o({slideCnt:ad,slideList:y,slideTime:aj,indexer:X,indexerOnClass:"active"});var r=setInterval(function(){if(M.windowFocused){if(b.index<ao){b.toIndex(b.index+1)}else{b.toIndex(1)}}},D);X.bind("click",function(aD){clearInterval(r)});var B=true,aC=1;$("._j_activity").click(function(aD){aD.preventDefault();var aE=$(aD.currentTarget),aF=aE.data("flag");if(aF==aC){return}aC=aF;if(B){B=false;$.get("/indexactivity/ajax.php",{act:"indexactivity",flag:aC,uid:window.Env.UID},function(aG){if(aG.data){$("._j_activitynav").html(aG.data.html);$("._j_activity").removeClass("active");aE.addClass("active")}B=true},"json")}});var K=$("#_j_tn"),Q=$("._j_tn_filter"),P=$("._j_filter_more"),ax=$("#_j_tn_content"),T=$("#_j_tn_nav");K.on("click","#_j_tn_nav li a",l).on("click","._j_tn_filter li a",Z);Q.each(function(aD,aE){var aF=$(aE);new aq({nav:aF,panel:aF.find(".dropdown-menu ul"),showCallback:function(aG,aH){aH.closest(".tn-dropdown").addClass("dropdown-open")},hideCallback:function(aG,aH){aH.closest(".tn-dropdown").removeClass("dropdown-open")}})});var ah=$("#_j_tn_pagination"),i=an("Pagination"),w=new i({total:600,pageSize:12,pageDisplayNum:9,container:ah,tmpl:"#article_pagination",callback:C});function l(aF){var aG=$(aF.currentTarget),aD=aG.closest("li"),aE=aG.data("type");ah.data("type",aE);aD.addClass("active").siblings().removeClass("active");Q.each(function(aH,aJ){var aK=$(aJ);aK.find("li").each(function(aL,aM){if(aL===0){$(aM).addClass("active")}else{$(aM).removeClass("active")}});var aI=aK.find(".dropdown-trigger");aI.find("span").html(aI.data("title"))});w.loadPage(1)}function Z(aD){var aF=$(aD.currentTarget),aG=aF.data("key"),aE=aF.closest("._j_tn_filter");Q.find('[data-key="'+aG+'"]').removeClass("active");aF.addClass("active");aE.find(".dropdown-trigger span").html(aF.text());aE.find("ul").hide();ah.data("type","8");if(P.hasClass("up_")){P.trigger("click")}w.loadPage(1)}function C(aD){aD=aD||1;var aF={start:aD,type:ah.data("type")},aE=Q.find(".active");if(aF.type=="8"&&aE.length){aE.each(function(){aF[$(this).data("key")]=$(this).data("value")})}$.get("/ajax/ajax_article.php",aF,function(aG){if(aG.ret==1&&aG.html){ax.fadeOut(700,function(){ax.html(aG.html).show();$("html,body").animate({scrollTop:T.offset().top},1500)});if(aG.pagesize&&aG.recordcount){w.total=aG.recordcount;w.pageSize=aG.pagesize;w.drawPage()}}},"json")}(function(){if($("#_js_fengshou").length){$("html").addClass("h100per")}$("#_js_fsStep2").delegate(".i_know","click",function(aD){$("#_js_fengshou").fadeOut(function(){$("html").removeClass("h100per")})})}())});var $searchResultType=true;M.define("/js/SiteSearch",function(c){var d=c("Suggestion"),b=window.Env||{};var a=function(o){var p=$("#"+o.Input+""),n=p.closest(".head-search-wrapper"),h=$("#_j_search_link"),m=$(".head-search form"),j=o.Input;var l=new d({url:(b.WWW_HOST?"http://"+b.WWW_HOST:"")+"/group/ss.php",input:p,listItemHoverClass:"active",dataType:"jsonp",createListContainer:function(){return $('<div class="search-suggest-panel search-suggest-all hide"><ul class="suggest-list"></ul></div>').appendTo("body")},handleSuggest:function(t){var r=t.data?g(t.data,$.trim(p.val())):[];p.data("droplist")["firstItemHover"]=t.exact==true;if(!r.length){p.data("droplist").hide()}else{var q=[];for(var s=0;s<r.length;s++){if(r[s]=="search://"){if(r[s+1]=="more"){q.push('<li class="ssp-more _j_listitem" data-type="'+r[s+1]+'" data-url="http://'+b.WWW_HOST+r[s+2]+'" data-title="'+r[s+4]+'">'+r[s+6]+"</li>")}else{q.push('<li class="_j_listitem" data-type="'+r[s+1]+'" data-url="http://'+b.WWW_HOST+r[s+2]+'" data-title="'+r[s+4]+'"><i class="'+r[s+3]+'"></i><span class="skey">'+r[s+6]+"</span><span>"+r[s+5]+"</span></li>")}s+=6}else{q.push("<li>"+r[s]+"</li>")}}return q.join("")}},updateList:function(q){this.listContainer.html(q)}});p.on("focus",function(q){n.addClass("head-search-focus")}).on("blur",function(q){n.removeClass("head-search-focus")});h.click(function(r){var q=$.trim(p.val());if(!!q&&$searchResultType){i(q,"","search_btn");location.href="/group/s.php?q="+q}});m.on("submit",function(){if($searchResultType==false){return false}i($.trim(p.val()),"","enter");location.href="/group/s.php?q="+p.val()});$(window).resize(function(){if(l.listContainer&&l.listContainer.length&&l.listContainer.is(":visible")){f(p,l.listContainer)}});M.Event(l).on("before show list",function(){f(p,l.listContainer)});M.Event(l).on("itemselected",function(r){var s=r.item;if(s.length){i($.trim(p.val()),s,"click");document.location.href=s.data("url")}else{var q=$.trim(p.val());if(!!q){location.href="/group/s.php?q="+q}else{return}}});var i=function(r,t,s){$searchResultType=false;var q={};q.search_category="suggest";q.url="/group/s.php?q="+encodeURIComponent(r);q.search_type="all";q.trigger=s;if(j=="inp-txt"){q.search_from="result_suggest"}else{q.search_from="top"}q.keyword=r;if(t.length){q.url=t.data("url");q.search_type=t.data("type")}q.trigger=q.search_type=="more"?"more":q.trigger;!!mfwPageEvent&&mfwPageEvent("se","result_click",q)};function f(q,s){var r=q.offset();s.css({left:r.left-4,top:r.top+p.outerHeight()+3})}function g(r,v){var s=[],x=r.split("|");v=e(v);for(var u=0;u<x.length;u++){var t=$.trim(x[u]);if(t=="search://"){var q=s.length;s[q]=x[u++];s[q+1]=x[u++];s[q+2]=x[u++];s[q+3]=x[u++];s[q+4]=x[u++];s[q+5]=x[u];continue}if(t){try{t=t.replace(new RegExp(v,"ig"),function(y){return'<span class="highlight">'+y+"</span>"})}catch(w){t=t.replace(v,function(y){return'<span class="highlight">'+y+"</span>"})}s[s.length]=t}}return s}var k=$("<div/>");function e(q){return k.text(q).html()}};return a});(function(a){a.fn.UpNum=function(d,e,b,c){return this.each(function(){var g=a(this).offset();var j=Math.round(g.left)+"px";var h=Math.round(g.top)+"px";if(d.toString().indexOf("-")==0){var k=Math.round(g.top)+30+"px"}else{var k=Math.round(g.top)-30+"px"}var f="20px";if(b){f=b}c=c||"120";var i=d||a(this).attr("money");a("<div/>").appendTo(a("body")).addClass("numeric").css({position:"absolute",top:h,left:j,color:(d.toString().indexOf("-")==0)?"#333":"red",fontFamily:"Georgia",fontSize:f,zIndex:c}).html(i).animate({top:k},{duration:1000,complete:function(){a(this).remove();if(e){e()}}})})};if(window.M&&typeof M.define=="function"){M.define("jq-upnum",function(){return jQuery})}})(jQuery);M.define("dialog/Layer",function(a){var g=0,f=550,d=(function(){return $.browser.msie&&parseInt($.browser.version,10)==7}()),c=(function(){return $.browser.msie&&parseInt($.browser.version,10)<7}());function b(){return g++}function e(h){this.opacity=0.8;this.background="#fff";this.impl="Dialog";this.fixed=true;M.mix(this,h);this.id="_j_layer_"+b();this.stacks=[];this.activeStackId=null;this.overflow=false;this.changeFixed=false;e.instances[this.id]=this;if(!e[this.impl]){e[this.impl]=[]}e[this.impl].push(this.id);this.init()}e.prototype={init:function(){this._createPanel()},_createPanel:function(){f++;var h={position:(!c&&this.fixed)?"fixed":"absolute",width:"100%",height:"100%",top:0,left:0},j=M.mix({},h,{"z-index":f,display:"none"}),k=M.mix({},h,{position:!c?"fixed":"absolute",background:this.background,opacity:this.opacity,"z-index":-1}),i=M.mix({},h,{"z-index":0},(!c&&this.fixed)?{"overflow-x":"hidden","overflow-y":"hidden"}:{overflow:"visible"});this._panel=$('<div id="'+this.id+'" class="layer _j_layer">                                <div class="layer_mask _j_mask"></div>                                <div class="layer_content _j_content"></div>                            </div>').css(j).appendTo("body");this._mask=this._panel.children("._j_mask").css(k);this._content=this._panel.children("._j_content").css(i)},setZIndex:function(h){f=h;this._panel.css("z-index",f)},toFront:function(){this.setZIndex(f+1)},setFixed:function(h){h=!!h;if(this.fixed!=h){this.changeFixed=true;this.fixed=h;if(!c&&this.fixed){this._panel.css("position","fixed");this._content.css({position:"fixed","overflow-x":"hidden","overflow-y":"hidden"})}else{this._panel.css("position","absolute");this._content.css({position:"absolute","overflow-x":"","overflow-y":"",overflow:"visible"})}}else{this.changeFixed=false}},newStack:function(i){var h=$(i).appendTo(this._content);this.stacks.push(h);return this.stacks.length-1},getStack:function(h){return this.stacks[h]},getActiveStack:function(){return this.stacks[this.activeStackId]},setActiveStack:function(h){this.activeStackId=h},getPanel:function(){return this._panel},getMask:function(){return this._mask},show:function(j){var i=this;if(this.visible){typeof j==="function"&&j();return}e.activeId=this.id;this.visible=true;if(c){var h=document.documentElement&&document.documentElement.scrollHeight||document.body.scrollHeight;this._panel.css("height",h);this._mask.css("height",h)}this._panel.fadeIn(200,function(){typeof j==="function"&&j()})},hide:function(i){var h=this;if(!this.visible){typeof i==="function"&&i();return}this.visible=false;if(c){this._panel.css("height","");this._mask.css("height","")}this._panel.fadeOut(200,function(){typeof i==="function"&&i();h._recoverTopScroller()})},setOverFlow:function(h){this.overflow=h;if(h){if(!c&&this.fixed){this._hideTopScroller();this._content.css("overflow-y","auto")}}else{if(!c&&this.fixed){this._content.css("overflow-y","hidden")}}},_hideTopScroller:function(){if(d){$("html").css("overflow","hidden")}else{if(!c){$("body").css("overflow","hidden")}else{$("body").css("overflow-x","hidden");this._panel.height($(document).height()+20)}}},_recoverTopScroller:function(){if(d){$("html").css("overflow","")}else{if(!c){$("body").css("overflow","")}else{$("body").css("overflow-x","")}}},destroy:function(){this.hide($.proxy(function(){this._panel&&this._panel.remove();this._panel=null;if(M.indexOf(e[this.impl],this.id)!=-1){e[this.impl].splice(M.indexOf(e[this.impl],this.id),1)}delete e.instances[this.id]},this))},clear:function(){this._content.empty();this.stacks=[];this.activeStackId=null}};e.instances={};e.activeId=null;e.getInstance=function(h){return e.instances[h]};e.getActive=function(h){var i=e.getInstance(e.activeId);if(h&&i){i=i.impl===h?i:null}return i};e.getImplInstance=function(i){var h=e.getActive(i);if(!h&&M.is(e[i],"Array")&&e[i].length){h=e.getInstance(e[i][e[i].length-1])}return h};e.closeActive=function(){var h=e.getActive();if(h&&h.getActiveStack()){h.getActiveStack().trigger("close")}};$(document).keyup(function(h){if(h.keyCode==27){e.closeActive()}});$(document).unload(function(){M.forEach(e.instances,function(){e.destroy()})});return e});M.define("dialog/DialogBase",function(b){var e=b("dialog/Layer"),a=M.Event,d=(function(){return $.browser.msie&&parseInt($.browser.version,10)<7}());function c(f){this.newLayer=false;this.width="";this.height="";this.background="#000";this.panelBackground="#fff";this.bgOpacity=0.7;this.stackable=true;this.fixed=true;this.reposition=false;this.autoPosition=true;this.minTopOffset=20;this.layerZIndex=-1;this.impl="Dialog";M.mix(this,f);this.visible=false;this.destroyed=false;this.positioned=false;this.resizeTimer=0;this.init()}c.prototype={tpl:"<div />",init:function(){this._createDialog();this._bindEvents()},_createDialog:function(){this._panel=$(this.tpl).css({position:"absolute",opacity:0,display:"none",background:this.panelBackground,"z-index":0});this.setRect({width:this.width,height:this.height});this._layer=!this.newLayer&&e.getImplInstance(this.impl)||new e({impl:this.impl});if(this.layerZIndex>=0){this._layer.setZIndex(this.layerZIndex)}this._layer.setFixed(this.fixed);this._layer.getMask().css({background:this.background,opacity:this.bgOpacity});this._stackId=this._layer.newStack(this._panel);this.setPanelContent()},_bindEvents:function(){var f=this;$(window).resize($.proxy(this.resizePosition,this));M.Event(this).on("resize",$.proxy(this.resizePosition,this));this._panel.delegate("._j_close, a[data-dialog-button]","click",function(g){var h=$(g.currentTarget).attr("data-dialog-button");if(h=="hide"){f.hide()}else{f.close()}g.preventDefault()});this._panel.bind("close",function(g,h){f.close(h)})},resizePosition:function(){var f=this;clearTimeout(this.resizeTimer);if(f.visible&&f.autoPosition){this.resizeTimer=setTimeout(function(){f.setPosition()},100)}},addClass:function(f){this._panel.addClass(f)},removeClass:function(f){this._panel.removeClass(f)},setRect:function(f){if(f.width){this._panel.css("width",f.width);this.width=f.width}if(f.height){this._panel.css("height",f.height);this.height=f.height}},getPanel:function(){return this._panel},getLayer:function(){return this._layer},getMask:function(){return this._layer&&this._layer.getMask()},setPanelContent:function(){},_getPanelRect:function(){var f=this.getPanel().clone().css({position:"absolute",visibility:"hidden",display:"block"}).appendTo("body"),g=f.outerHeight(),h=f.outerWidth();f.remove();return{height:g,width:h}},_getNumric:function(f){f=parseInt(f,10);return isNaN(f)?0:f},setPosition:function(f){var g=this._getPanelRect(),h={width:$(window).width(),height:$(window).height()};var k=(h.width-(this._getNumric(this.width)>0?this._getNumric(this.width):g.width))/2,j=(h.height-(this._getNumric(this.height)>0?this._getNumric(this.height):g.height))*2/5;j=j<this.minTopOffset?this.minTopOffset:j;if(d||!this.fixed){var i=$(window).scrollTop();if(i>0){j+=i}}f={left:(f&&f.left)||k,top:(f&&f.top)||j};if(!d&&this.fixed){if(h.height-g.height<=f.top){this.getPanel().addClass("dialog_overflow");this._layer.setOverFlow(true)}else{this.getPanel().removeClass("dialog_overflow");this._layer.setOverFlow(false)}}var l=this.positioned?"animate":"css";$.fn[l].call(this.getPanel(),f,200);this.positioned=true;this.position=f},setFixed:function(f){this.fixed=!!f;this._layer.setFixed(this.fixed)},getPosition:function(){return this.position},show:function(f){if(this.visible){return}var h=this;a(this).fire("beforeshow");var g;if(this._layer.getActiveStack()){g=this._layer.getActiveStack();if(!this.reposition&&!f&&!this._layer.changeFixed){f=this._layer.getActiveStack().position()}}this._layer.show();this.getPanel().css({display:"","z-index":1});this.setPosition(f);g&&g.trigger("close",[true]);this.visible=true;this._layer.setActiveStack(this._stackId);this.getPanel().animate({opacity:1},{queue:false,duration:200,complete:function(){a(h).fire("aftershow")}})},close:function(){var f=this.stackable?"hide":"destroy";this[f].apply(this,Array.prototype.slice.call(arguments))},hide:function(g,f){if(typeof g=="function"){f=g;g=undefined}if(!this.visible){typeof f=="function"&&f();return}a(this).fire("beforeclose");a(this).fire("beforehide");this._layer.setActiveStack(null);this.visible=false;if(!g){this._layer.hide()}this.getPanel().animate({opacity:0},{queue:false,duration:200,complete:$.proxy(function(){this.getPanel().css({display:"none","z-index":0});a(this).fire("afterhide");a(this).fire("afterclose");typeof f=="function"&&f()},this)})},destroy:function(g,f){if(typeof g=="function"){f=g;g=undefined}if(this.destroyed){M.log("Dialog already destroyed!");typeof f=="function"&&f();return}a(this).fire("beforeclose");a(this).fire("beforedestroy");this.destroyed=true;this.hide(g,$.proxy(function(){if(this._panel.length){this._panel.undelegate();this._panel.unbind();this._panel.remove();this._panel=null}this._layer=null;a(this).fire("afterdestroy");a(this).fire("afterclose");typeof f=="function"&&f()},this))}};return c});M.define("dialog/Dialog",function(c){var d=c("dialog/DialogBase"),a='<div class="popup-box layer_dialog _j_dialog pop_no_margin">                    <div class="dialog_title" style="display:none"><div class="_j_title title"></div></div>                    <div class="dialog_body _j_content"></div>                    <a id="popup_close" class="close-btn _j_close"><i></i></a>                </div>';var b=M.extend(function(e){this.content="";this.title="";this.PANEL_CLASS="";this.MASK_CLASS="";b.$parent.call(this,e)},d);M.mix(b.prototype,{tpl:a,setPanelContent:function(){this._dialogTitle=this._panel.find("._j_title");this._dialogContent=this._panel.find("._j_content");this.setTitle(this.title);this.setContent(this.content);this.addClass(this.PANEL_CLASS);this.getMask().addClass(this.MASK_CLASS)},setTitle:function(e){if(e){this._dialogTitle.html(e).parent().css("display","")}else{this._dialogTitle.parent().css("display","none")}this.title=e},getTitle:function(){return this.title},setContent:function(e){this._dialogContent.empty().append(e)}});return b});M.define("TopTip",function(b,a,c){return{show:function(d){var d=$('<div id="over_container"><div id="over_message">'+d+"</div></div>").appendTo("body");setTimeout(function(){d.hide("fast",function(){d.remove()})},3000)}}});